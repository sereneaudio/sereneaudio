
<footer class="site-footer">
</footer>
<!-- MailChimp popup form Start-->
<script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">require(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us4.list-manage.com","uuid":"bca13a7f717c1621a9ba4647c","lid":"98e4f73548"}) })</script>
<!-- MailChimp popup form End-->
<script src='{{ site.baseurl }}/js/dropcap.min.js'></script>
<script>
    // We retrieve our drop cap elements using a class selector...
    var dropcaps = document.querySelectorAll(".dropcap");
    window.Dropcap.layout(dropcaps, 2);
    function updateSize(){
        window.Dropcap.layout(dropcaps, 2)
    }
    //Font size changes with a media quary at 768px window width, so we update dropcap sizes
    var narrow = window.matchMedia("screen and (max-width: 768px)");
    narrow.addListener(updateSize);
</script>
<script>

    //Keyword rank tracker
    if (document.referrer.match(/google\./gi) && document.referrer.match(/cd/gi)) {
        /*http://cutroni.com/blog/2013/01/14/a-new-method-to-track-keyword-ranking-using-google-analytics/*/
        var myString = document.referrer;
        var r        = myString.match(/cd=(.*?)&/);
        var rank     = parseInt(r[1]);
        var kw       = myString.match(/q=(.*?)&/);

        if (kw[1].length > 0) {
            var keyWord  = decodeURI(kw[1]);
        } else {
            keyWord = "(not provided)";
        }
        var p        = document.location.pathname;
        ga('send', 'event', 'RankTracker', keyword,  p, rank, {'nonInteraction': 1});
    }

    //Scroll behaviour tracking
    jQuery(function($) {
        // Debug flag
        var debugMode = false;

        // Default time delay before checking location
        var callBackTime = 100;

        // # px before tracking a reader
        var readerLocation = 150;

        // Set some flags for tracking & execution
        var timer = 0;
        var scroller = false;
        var endContent = false;
        var didComplete = false;

        // Set some time variables to calculate reading time
        var startTime = new Date();
        var beginning = startTime.getTime();
        var totalTime = 0;

        // Get some information about the current page
        var pageTitle = document.title;

        // Track the aticle load
        if (!debugMode) {
            //_gaq.push(['_trackEvent', 'Reading', 'ArticleLoaded', '', , true]);
            ga('send', 'event', 'Reading', 'PageLoaded',  '', 0, {'nonInteraction': 1});
        } else {
            alert('The page has loaded. Woohoo.');
        }

        // Check the location and track user
        function trackLocation() {
            bottom = $(window).height() + $(window).scrollTop();
            height = $(document).height();

            // If user starts to scroll send an event
            if (bottom > readerLocation && !scroller) {
                currentTime = new Date();
                scrollStart = currentTime.getTime();
                timeToScroll = Math.round((scrollStart - beginning) / 1000);
                if (!debugMode) {
                    //_gaq.push(['_trackEvent', 'Reading', 'StartReading', '', timeToScroll]);
                    ga('send', 'event', 'Reading', 'StartReading',  '', timeToScroll);
                } else {
                    alert('started reading ' + timeToScroll);
                }
                scroller = true;
            }

            // If user has hit the bottom of page send an event
            if (bottom >= height && !didComplete) {
                currentTime = new Date();
                end = currentTime.getTime();
                totalTime = Math.round((end - scrollStart) / 1000);
                if (!debugMode) {
                    if (totalTime < 60) {
                        //_gaq.push(['_setCustomVar', 5, 'ReaderType', 'Scanner', 2]);
                        ga('set', 'dimension1', 'Scanner'); //I set up dimension1 to be readerType in GA
                    } else {
                        //_gaq.push(['_setCustomVar', 5, 'ReaderType', 'Reader', 2]);
                        ga('set', 'dimension1', 'Reader'); //I set up dimension1 to be readerType in GA
                    }
                    //_gaq.push(['_trackEvent', 'Reading', 'PageBottom', pageTitle, totalTime]);
                    ga('send', 'event', 'Reading', 'PageBottom',  pageTitle, totalTime);
                } else {
                    alert('bottom of page '+totalTime);
                }
                didComplete = true;
            }
        }

        // Track the scrolling and track location
        $(window).scroll(function() {
            if (timer) {
                clearTimeout(timer);
            }

            // Use a buffer so we don't call trackLocation too often.
            timer = setTimeout(trackLocation, callBackTime);
        });
    });

//mixpanel track page view
    mixpanel.track('page viewed', {
        'page name' : document.title,
        'url' : window.location.pathname
    });

    function hideAddressBar()
    {
        if(!window.location.hash)
        {
            if(document.height < window.outerHeight)
            {
                document.body.style.height = (window.outerHeight + 50) + 'px';
            }

            setTimeout( function(){ window.scrollTo(0, 1); }, 50 );
        }
    }

    window.addEventListener("load", function(){ if(!window.pageYOffset){ hideAddressBar(); } } );
    window.addEventListener("orientationchange", hideAddressBar );





    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-24800063-4', 'auto');
    ga('require', 'displayfeatures');
    ga('require', 'linkid', 'linkid.js');

    //ABalytics.init sould be called before ga('send', 'pageview');
    ABalytics.init({
        experiment1_name: [
            {
                name: 'variant1_name',
                "experiment1_class1_name": "wireless speaker system"
            },
            {
                name: 'variant2_name',
                "experiment1_class1_name": "product"
            }
        ]
    }, 2);
    ga('send', 'pageview');

</script>
<!--Adroll Script Begin-->
<script type="text/javascript">
    adroll_adv_id = "QEEFUX6XDFGTXLVO54ZWUF";
    adroll_pix_id = "VEKKYQBPQ5AKHORMJ2JCQJ";
    (function () {
        var oldonload = window.onload;
        window.onload = function(){
            __adroll_loaded=true;
            var scr = document.createElement("script");
            var host = (("https:" == document.location.protocol) ? "https://s.adroll.com" : "http://a.adroll.com");
            scr.setAttribute('async', 'true');
            scr.type = "text/javascript";
            scr.src = host + "/j/roundtrip.js";
            ((document.getElementsByTagName('head') || [null])[0] ||
             document.getElementsByTagName('script')[0].parentNode).appendChild(scr);
            if(oldonload){oldonload()}};
    }());
</script>
<!--Adroll Script End-->
